{"version":3,"file":"errx.js","names":[],"sources":["../../../../errx/dist/index.js"],"sourcesContent":["const IS_ABSOLUTE_RE = /^[/\\\\](?![/\\\\])|^[/\\\\]{2}(?!\\.)|^[a-z]:[/\\\\]/i;\nconst LINE_RE = /^\\s+at (?:(?<function>[^)]+) \\()?(?<source>[^)]+)\\)?$/u;\nconst SOURCE_RE = /^(?<source>.+):(?<line>\\d+):(?<column>\\d+)$/u;\nfunction captureRawStackTrace() {\n  if (!Error.captureStackTrace) {\n    return;\n  }\n  const stack = new Error();\n  Error.captureStackTrace(stack);\n  return stack.stack;\n}\nfunction captureStackTrace() {\n  const stack = captureRawStackTrace();\n  return stack ? parseRawStackTrace(stack) : [];\n}\nfunction parseRawStackTrace(stacktrace) {\n  const trace = [];\n  for (const line of stacktrace.split(\"\\n\")) {\n    const parsed = LINE_RE.exec(line)?.groups;\n    if (!parsed) {\n      continue;\n    }\n    if (!parsed.source) {\n      continue;\n    }\n    const parsedSource = SOURCE_RE.exec(parsed.source)?.groups;\n    if (parsedSource) {\n      Object.assign(parsed, parsedSource);\n    }\n    if (IS_ABSOLUTE_RE.test(parsed.source)) {\n      parsed.source = `file://${parsed.source}`;\n    }\n    if (parsed.source === import.meta.url) {\n      continue;\n    }\n    for (const key of [\"line\", \"column\"]) {\n      if (parsed[key]) {\n        parsed[key] = Number(parsed[key]);\n      }\n    }\n    trace.push(parsed);\n  }\n  return trace;\n}\n\nexport { captureRawStackTrace, captureStackTrace, parseRawStackTrace };\n"],"mappings":";AAAA,IAAM,iBAAiB;AACvB,IAAM,UAAU;AAChB,IAAM,YAAY;AAClB,SAAS,uBAAuB;AAC9B,KAAI,CAAC,MAAM,kBACT;CAEF,MAAM,wBAAQ,IAAI,OAAO;AACzB,OAAM,kBAAkB,MAAM;AAC9B,QAAO,MAAM;;AAEf,SAAS,oBAAoB;CAC3B,MAAM,QAAQ,sBAAsB;AACpC,QAAO,QAAQ,mBAAmB,MAAM,GAAG,EAAE;;AAE/C,SAAS,mBAAmB,YAAY;CACtC,MAAM,QAAQ,EAAE;AAChB,MAAK,MAAM,QAAQ,WAAW,MAAM,KAAK,EAAE;EACzC,MAAM,SAAS,QAAQ,KAAK,KAAK,EAAE;AACnC,MAAI,CAAC,OACH;AAEF,MAAI,CAAC,OAAO,OACV;EAEF,MAAM,eAAe,UAAU,KAAK,OAAO,OAAO,EAAE;AACpD,MAAI,aACF,QAAO,OAAO,QAAQ,aAAa;AAErC,MAAI,eAAe,KAAK,OAAO,OAAO,CACpC,QAAO,SAAS,UAAU,OAAO;AAEnC,MAAI,OAAO,WAAW,OAAO,KAAK,IAChC;AAEF,OAAK,MAAM,OAAO,CAAC,QAAQ,SAAS,CAClC,KAAI,OAAO,KACT,QAAO,OAAO,OAAO,OAAO,KAAK;AAGrC,QAAM,KAAK,OAAO;;AAEpB,QAAO"}